Class-ification followup
========================

** 2.ðŸ›+ **


Follow up jobs from class-ification.

```
2025-10-22		New Task
2025-11-06		2.0.1	First lot of follow up jobs done
```

The main work of converting everything into classes is done.
Now, as far as i can tell, there's nothing in the global window namespace anymore, everything is somewhere under `yearclock`, or `ldpercy` for the HTMLApp class.

But for the first pass I avoided a lot of possible refactors, time to start looking at them.
In no particular order:

* Angles should be converted to angle objects like I've done in Turtle
* DegreeDelta and RadianDelta should be combined and renamed to range, as they usually represent concrete angular spaces, not differences
* Bring in a version of the PlanarSpace class from turtle called something like SVGPage with the cartesian and polar coordinates fixed - might want to wait until I have the parameterisation for that working properly first
* Bring in some of the SVG class from turtle for things like rectangles and viewboxes, probably the grids too
* See if more of the common things can be moved to the `ldpercy` namespace
* Create a proper Event class so that custom ones can be built
* Get a proper PeriodArray base class going to consolidate a lot of disparate code
* I have no idea what to do about localisation yet....
* Probably convert some of the static Date methods to instance methods
* Go back to YearClock.js and sort out some of the methods I dumped in there
* What is currently ThemeBase could probably be largely converted to one or more library classes with static methods, or organised into proper classes.
* Convert a lot what are currently class function fields to proper methods
* Have another look at the function eval style used for the hand config (`function : ()=>this.getHand1,`,`yearHandFunc = (handConfig.function) ? handConfig.function() `) - see if I can do this normally now


There's lots more, but that should keep me busy for a little while :-)


Angles
------

Start with something fairly easy.
Though I'm already thinking about the difference between absolute angles and relative angles (actual angular positions vs between arbitrary lines).
Hopefully that can mostly be clarified by naming and context.

### Deltas & ranges
Looks like I named them deltas because they're set up as a starting position and a width.
Not really a delta then, but i get the idea.
The other good things about that arrangement is that it's clear which way the range goes (+/-ve), and can represent rotations greater than 360 degrees.
Sooo... not actually a bad idea at all - go former me.

### Tear it up
I'm gonna seriously tear up a bunch of the old divisionRadians, dateRadians, blahRadians etc code.
Just torch it and rewrite it so it makes sense.

Here we go...



	addDateRangeRadians
	dateRangeRadians				--> dateRangeAngularRange
	dateRadians						--> dateAngularRange
	divisionRadians


I've run pretty far ahead here, all the angles and angular ranges converted over now.
Still trying to decide how to best handle dateRange-angularRange mapping though, and partially through the 'crappy code' block.
Will return.


Function fields vs methods
--------------------------

At the beginning of writing classes i started out with this style which may have hobbled me a bit:

```js
	getThemeSVG = function() { ... }
```

There are some differences between this and regular method style that I'm still trying to nail down, but for now will convert most things to methods.
I think scopes/this work a little differently between them.





DayRange and Period Collections
-------------------------------

DayRange is a tentative class for storing day sequences.
It's meant to replace `getPeriodDayArray`, but I've only partially converted it so far.

In general though I need much better ways of doing these sort of things.
* contiguous day arrays for month and year
* arbitrary day collections for day-events
* contiguous period arrays for weeks, months, seasons etc
* arbitrary period collections for other kinds of notable time periods (terms, semesters, holidays etc)

So wondering whether they should all be the same type, or collections of the same type or something like that.


Half inclined to just push up what I have as 2.0.1 first.


Wrapup for 2.0.1 Mini-release
=============================

Before I go on to figuring out day/date ranges want to push up current progress.

* Add page accent colour
* All angles converted over to Angle objects that handle degrees/radians conversion implicitly
* DegreeDelta and Radiandelta changed to AngularRange
* Various updates for yearclock.Date
* Convert class function fields to methods
* Get rid of evaluation call for hand functions




